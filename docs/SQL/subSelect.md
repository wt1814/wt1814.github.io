

# ~~分库分表及多维度查询~~

<!-- 
https://blog.csdn.net/coolmsn8786/article/details/100377411
-->

* 记录两份数据，一份按照用户纬度分表，一份按照视频ID维度分表。按照订单使用者拆分为3个数据库，客户端、商家端、渠道端，目的是分散压力，提高吞吐量，互不影响  
* 以用户维度分库，在单个库里，以其他维度进行分区操作  
* 通过搜索引擎解决，但如果实时性要求很高，又得关系到实时搜索。

**<font color = "clime">1. 方案一：以第一维度进行拆分，第二维度拼接第一维度。2. 方案二：数据冗余。</font>**

&emsp; 以电商模型订单库为目标问题。  
1. 以用户id为分片键，订单号尾部拼接用户id后四位。根据后四位取模分片。  
2. 订单号维度查询，订单号后四位定位库。用户维度查询，支持分页。  
3. 如果涉及到其他维度，比如订单里面有商品，商家需要根据商品维度查询排序分页，可以双写一份商家备份库，因为商家查询频率不会和c端用户一样高，且对实时性要求️有容忍性，所以可以用biolog同步双写数据。  
4. 如果还有其他一些查询频率更低，且实时性无要求，也通过biolog同步一份数据到kudu数据仓库，利用大数据olap等技术做查询操作。  


