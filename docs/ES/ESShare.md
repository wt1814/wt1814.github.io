


# ES分片  
<!-- 
https://blog.csdn.net/wlei0618/article/details/127434907

Elasticsearch索引分片的数量及大小分配策略
https://blog.csdn.net/wlei0618/article/details/127434907

es 分片数量
https://www.cnblogs.com/ah-firelove/p/14074723.html

https://www.jianshu.com/p/49643a707eac

-->


分片(shard): 因为 ES 是个分布式的搜索引擎, 所以索引通常都会分解成不同部分, 而这些分布在不同节点的数据就是分片. ES自动管理和组织分片, 并在必要的时候对分片数据进行再平衡分配, 所以用户基本上不用担心分片的处理细节.  
副本(replica): ES 默认为一个索引创建 5 个主分片, 并分别为其创建一个副本分片. 也就是说每个索引都由 5 个主分片成本, 而每个主分片都相应的有一个 copy。  



## 分片大小  
在 Elasticsearch 中，每个查询都是在单个分片上以单线程方式执行的。然而，可以同时对多个分片进行处理，正如可以针对同一分片进行多次查询和聚合一样。  

这意味着，最低查询延时（假设没有缓存）将取决于数据、查询类型，以及分片大小。尽管查询很多个小分片会加快单个分片的处理速度，但是由于有很多任务需要进入队列并按顺序加以处理，所以与查询较少的大分片相比，这种方法并不一定会加快查询速度。如果有多个并发查询，拥有很多小分片还会降低查询吞吐量。  


## ElasticSearch分片参数设置  
<!-- 
https://blog.csdn.net/m0_67392273/article/details/126660466
-->

一般以节点数*1.5或3倍来计算，比如有4个节点，分片数量一般是6到12个，每个分片一般分配一个副本  




