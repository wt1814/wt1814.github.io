
<!-- TOC -->

- [1. 网络的性能指标](#1-网络的性能指标)
    - [1.1. 性能指标有哪些？](#11-性能指标有哪些)
    - [1.2. 查看](#12-查看)
        - [1.2.1. 网络吞吐率和 PPS 如何查看？](#121-网络吞吐率和-pps-如何查看)
        - [1.2.2. 连通性和延时如何查看？](#122-连通性和延时如何查看)

<!-- /TOC -->

# 1. 网络的性能指标
<!--

带宽设置多少？
抖音服务器带宽有多大，才能供上亿人同时刷？ 
https://mp.weixin.qq.com/s/jRYFJwStJ6tJilECyj1SCA


带宽、延时、吞吐率、PPS 这些都是啥？ 
https://mp.weixin.qq.com/s/MIIRaMOqlrXx_8w3bvJ4nA
-->

## 1.1. 性能指标有哪些？ 

<!-- 
https://jingyan.baidu.com/article/19192ad855674ea43f570744.html

一、带宽（bandwidth）
    在单位时间内从网络中的某一点到另一点所能通过的“最高数据率”。对于带宽的概念，比较形象的一个比喻是高速公路。
    单位时间内能够在线路上传送的数据量，常用的单位是bps(bit per second)。
二、延迟（delay）
    描述网络上数据从一个节点传送到另一个节点所经历的时间。延迟是反馈慢，就是你打中敌人，他会在几秒后死去。丢包类似穿越火线瞬移。延迟类似王者荣耀卡一段时间后，屏幕飞快运行。

* 比特：比特(bit)是计算机中数据量的单位，也是信息论中使用的信息量的单位。英文单词bit来源于binary digit，意思是一个“二进制数字”。网络技术中的速率指的是连接在计算机网络上的主机在数字信道上传送数据的速率，它也称为数据率(data rate)或比特率(bit rate)。  
* **<font color = "red">带宽：</font>** 在计算机网络中，带宽用来表示网络的通信线路传送数据的能力，因此网络带宽表示单位时间内从网络中的某一点到另一点所能通过的“最高数据率”。这种意义的带宽的单位是比特/秒。  
* 吞吐量：吞吐量(throughput)表示在单位时间内通过某个网络(或信道、接口)的数据量，表示当前网络传输数据的能力。  
* 时延：
    1. 发送时延：指主机或路由器发送数据帧所需要的时间，也就是从发送数据帧的第一个比特算起，到该帧的最后一个比特发送完毕所需要的时间。  
    2. 传播时延：指电磁波在信道中传播一定距离需要花费的时间。  
* 时延带宽积：时延带宽积表示链路可容纳的比特数，因此，链路的时延带宽积又称为以比特为单位的链路长度。  
* 往返时间RTT：往返时间RTT，表示从发送方发送数据开始，到发送方收到来自接收方的确认(接收方收到数据后便立即发送确认)，总共经历的时间。往返时间一般就会包括分组在网络中的各种时延。  
* 利用率：利用率可以分为信道利用率和网络利用率两种。信道利用率指出某信道有百分之几的时间是被利用的(有数据通过)。完全空闲的信道的利用率是零。网络的利用率则是全网络的信道利用率的加权平均值。信道利用率并非越高越好，这是因为，根据排队论的理论，当某信道的利用率增大时，该信道引起的时延也会迅速增加。信道或网络的利用率过高会产生非常大的时延。  

-->

<!-- 

*** 18张图带你了解衡量网络性能的四大指标：带宽、时延、抖动、丢包 
https://mp.weixin.qq.com/s/Yjoh1BRJlfY6R5wpwAy3JQ
-->

&emsp; **<font color = "red">通常是以4个指标来衡量网络的性能，分别是`带宽、延时、吞吐率、PPS(Packet Per Second)`。</font>** 它们表示的意义如下：  

* 带宽，表示链路的最大传输速率，单位是b/s(比特 / 秒)，带宽越大，其传输能力就越强。
* 延时，表示请求数据包发送后，收到对端响应，所需要的时间延迟。不同的场景有着不同的含义，比如可以表示建立 TCP 连接所需的时间延迟，或一个数据包往返所需的时间延迟。
* 吞吐率，表示单位时间内成功传输的数据量，单位是b/s(比特 / 秒)或者 B/s(字节 / 秒)，吞吐受带宽限制，带宽越大，吞吐率的上限才可能越高。
* PPS，全称是Packet Per Second(包 / 秒)，表示以网络包为单位的传输速率，一般用来评估系统对于网络的转发能力。

&emsp; 当然，除了以上这四种基本的指标，还有一些其他常用的性能指标，比如：  

* 网络的可用性，表示网络能否正常通信；
* 并发连接数，表示 TCP 连接数量；
* 丢包率，表示所丢失数据包数量占所发送数据组的比率；
* 重传率，表示重传网络包的比例；





## 1.2. 查看  
### 1.2.1. 网络吞吐率和 PPS 如何查看？ 
&emsp; 可以使用sar命令当前网络的吞吐率和 PPS，用法是给 sar 增加 -n 参数就可以查看网络的统计信息，比如：  

* sar -n DEV，显示网口的统计数据；
* sar -n EDEV，显示关于网络错误的统计数据；
* sar -n TCP，显示TCP的统计数据；

&emsp; 比如，通过 sar 命令获取了网口的统计信息：   
![image](http://182.92.69.8:8081/img/network/network-1.png)  
&emsp; 它们的含义：  

* rxpck/s 和 txpck/s 分别是接收和发送的 PPS，单位为包 / 秒。
* rxkB/s 和 txkB/s 分别是接收和发送的吞吐率，单位是 KB/ 秒。
* rxcmp/s 和 txcmp/s 分别是接收和发送的压缩数据包数，单位是包 / 秒。

&emsp; 对于带宽，可以使用 ethtool 命令来查询，它的单位通常是 Gb/s 或者 Mb/s，不过注意这里小写字母 b ，表示比特而不是字节。通常提到的千兆网卡、万兆网卡等，单位也都是比特（bit）。如下可以看到，eth0 网卡就是一个千兆网卡：  

```text
$ ethtool eth0 | grep Speed
  Speed: 1000Mb/s
```

### 1.2.2. 连通性和延时如何查看？
&emsp; 要测试本机与远程主机的连通性和延时，通常是使用 ping 命令，它是基于 ICMP 协议的，工作在网络层。  
&emsp; 比如，如果要测试本机到 192.168.12.20 IP 地址的连通性和延时：  
![image](http://182.92.69.8:8081/img/network/network-2.png)  
&emsp; 显示的内容主要包含icmp_seq（ICMP 序列号）、TTL（生存时间，或者跳数）以及 time（往返延时），而且最后会汇总本次测试的情况，如果网络没有丢包，packet loss的百分比就是0。  
&emsp; 不过，需要注意的是，ping不通服务器并不代表HTTP请求也不通，因为有的服务器的防火墙是会禁用ICMP协议的。  
