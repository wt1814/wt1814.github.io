

<!-- TOC -->

- [1. ~~责任链(Chain of Responsibility)模式~~](#1-责任链chain-of-responsibility模式)
    - [1.1. 简介](#11-简介)
    - [1.2. 结构](#12-结构)
    - [1.3. 责任链模式和建造者模式](#13-责任链模式和建造者模式)

<!-- /TOC -->
 

# 1. ~~责任链(Chain of Responsibility)模式~~  
<!-- 
重学设计模式  

-->

## 1.1. 简介
&emsp; 责任链模式是将链中每一个节点看作是一个对象，每个节点处理的请求均不同，且内部自动维护一个下一节点对象。当一个请求从链式的首端发出时，会沿着链的路径依次传递给每一个节点对象，直至有对象处理这个请求为止。  
&emsp; 责任链模式的本质是解耦请求于处理，让请求在处理链中能进行传递与被处理。责任链模式的独到之处是其将节点处理者组合成链链式结构，并允许节点自身决定是否进行请求处理或转发，相当于请求流动链起来。  

&emsp; **适用场景：** 责任链模式主要是解耦了请求与处理，客户只需将请求发送到链上即可，无需关心请求的具体内容和处理细节，请求会自动进行传递直至有节点对象进行处理。适用于以下应用场景：  
1. 多个对象可以处理同一请求，但具体由哪个对象处理则在运行时动态决定；
2. 在不明确指定接收者但情况下，向多个对象中的一个提交一个请求；
3. 可动态指定一组对象处理请求。  

&emsp; **<font color = "red">servlet中的filter、mybatis中的plugin、dubbo中的filter都使用了责任链模式。</font>**  

&emsp; **优点：**  
1. 将请求与处理接耦；  
2. 请求处理者(节点对象)只需关注自己感兴趣的请求进行处理即可，对于不感兴趣的请求，直接转发给下一级节点对象；  
3. 具备链式传递处理请求功能，请求发送者无需知晓链路结构，只需等待请求处理结果；  
4. 链路结构灵活，可以通过改变链路结构动态地新增或删减责任；  
5. 易于扩展新地请求处理类(节点)，符合开闭原则。  

&emsp; **缺点：**  
1. 责任链太长或者处理时间过长，会影响整体性能。  
2. 如果节点对象存在循环引用时，会造成死循环，导致系统崩溃。  

## 1.2. 结构  
&emsp; **模式角色组成：**  
![image](http://www.wt1814.com/static/view/images/java/design/design-17.png)  

* 抽象处理者(Handler)角色：定义出一个处理请求的接口。如果需要，接口可以定义出一个方法以设定和返回对下家的引用。这个角色通常由一个Java抽象类或者Java接口实现。Handler类的聚合关系给出了具体子类对下家的引用，抽象方法handleRequest()规范了子类处理请求的操作。  
* 具体处理者(ConcreteHandler)角色：具体处理者接到请求后，可以选择将请求处理掉，或者将请求传给下家。由于具体处理者持有对下家的引用，因此，如果需要，具体处理者可以访问下家。  

## 1.3. 责任链模式和建造者模式  
&emsp; 链式结构组装复杂时，可以结合建造者模式。  

