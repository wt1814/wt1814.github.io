<!-- TOC -->

- [1. 面试准备](#1-面试准备)
    - [1.1. 项目介绍](#11-项目介绍)
    - [1.2. 自我介绍](#12-自我介绍)
    - [1.3. 简历制作](#13-简历制作)

<!-- /TOC -->



# 1. 面试准备

## 1.1. 项目介绍  
&emsp; 本人负责收款支付对接业务的重构（首先说明一下，统一对接平台属于边缘系统，并不涉及支付的动作，支付由人保收银台项目组完成）。  
&emsp; 重构过程中，首先充分了解需求，梳理老架构中的请求报文、返回报文。本业务涉及两个微服务：投保微服务、收款支付微服务（微服务按照功能划分，投保微服务负责保单数据，收款支付负责订单数据）。设计了3张表：1张配置表（属于复制表/全局表，所有节点都有全量数据）、投保微服务中一张订单号路由表（关联订单和投保单），以订单号作为分布id，此前系统中已有投保保单号的路由表、收款支付微服务中一张订单详情表。业务表做冷热分区。  
&emsp; 业务分为3个流程，出投保单、在线支付校验、支付回调。流程中采用腾讯云TCC事务。  
&emsp; 出投保单流程是合作方调用统一对接平台投保微服务、投保微服务调用收款支付微服务。在投保微服务中采用多态、模版模式等复用了一套标准流程的代码。在投保流程中因为老架构采用xml作为数据传输，新架构采用json作为数据传输，因为报文字段可能都不一致，采用了velocity做一次模版转换。节点校验和核保校验因为业务复杂，并没有使用校验框架和规则引擎，而是采用数据库配置和编码方式解决，数据库中配置一些复杂的校验规则，如起保时间校验{}。在收款支付微服务中采用百度的uid-generator生成订单id。  
&emsp; 在线支付校验流程中，因为收银台分pc和wap，两者的请求报文和返回报文不一致，但设计在同一个接口中，因此将请求参数、返回参数用范型方法包裹了一下。  
&emsp; 支付回调流程中，收银台支付成功后，才会回调统一对接平台收款支付微服务，然后再调投保微服务，由投保微服务调用合作方。回调流程中，采用了重试。并且如果接口失败率过高，腾讯云也会进行报警。  

------
&emsp; 本人负责收款支付对接业务的重构，由老系统的业务重构到新系统中，后期进行业务切换。涉及3个系统：合作方、我们系统统一对接平台、人保收银台，其中支付的动作由收银台完成。  
&emsp; 本系统涉及两个微服务：投保对接微服务、收款支付对接微服务。投保微服务存储保单数据，跟合作方交互；收款支付存储订单数据，跟人保收银台系统交互。设计了3张表：1张配置表（属于复制表/全局表，所有节点都有全量数据）、投保微服务中一张订单号路由表（关联订单和投保单），以订单号作为分布id，此前系统中已有投保保单号的路由表、收款支付微服务中一张订单详情表。业务表做冷热分区。  
&emsp; 业务分为3个流程，出投保单、在线支付校验、支付回调。流程中采用腾讯云TCC事务。 

* 出投保单：出投保单流程是合作方调用统一对接平台投保微服务、投保微服务调用收款支付微服务。在投保微服务中采用多态、模版模式等复用了一套标准流程的代码。在投保流程中因为老架构采用xml作为数据传输，新架构采用json作为数据传输，因为报文字段可能都不一致，采用了velocity做一次模版转换。节点校验和核保校验因为业务复杂，并没有使用校验框架和规则引擎，而是采用数据库配置和编码方式解决，数据库中配置一些复杂的校验规则，如起保时间校验{}。在收款支付微服务中采用百度的uid-generator生成订单id。  
* 在线支付校验：因为收银台分pc和wap，两者的请求报文和返回报文不一致，但设计在同一个接口中，因此将请求参数、返回参数用范型方法包裹了一下。  
* 支付回调：收银台回调收款支付微服务，如果修改订单详情表订单状态成功，则返回收银台通知成功，否则收银台重试。收款支付回调投保微服务失败，触发熔断降级，降级方案中再次使用ribbon重试请求，还是请求失败，放到消息队列中，由消息队列消费，消费失败，触发报警。（注：接口失败率过高，腾讯云会报警。）在投保微服务中，调用合作方，触发熔断也会报警提示。  



## 1.2. 自我介绍  

## 1.3. 简历制作 
制作内容
https://www.zhihu.com/question/25002833

制作模版  
https://mp.weixin.qq.com/s/z0k922U6jwXe5VYlz33gaA




