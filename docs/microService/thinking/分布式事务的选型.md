


# 1. 分布式事务的选型  

&emsp; 一个好的分布式事务框架应用尽可能满足以下特性：  

* 业务改造成本低；
* 性能损耗低；
* 隔离性保证完整。

## 1.1. 选型取舍关键  

&emsp; 分布式中间件的选型都基于数据一致性的cap、base理论。重点回顾一下<font color = "red">数据一致性：</font> 

* 强一致性：数据更新成功后，任意时刻所有副本中的数据都是一致的，一般采用同步的方式实现。  
* 弱一致性：数据更新成功后，系统不承诺立即可以读到最新写入的值，也不承诺具体多久之后可以读到。    
* 最终一致性：弱一致性的一种形式，数据更新成功后，系统不承诺立即可以返回最新写入的值，但是保证最终会返回上一次更新操作的值。  
* 单调一致性（monotonic consistency）。任何时刻，任何用户一旦读到某个数据在某次更新后的值，那么就不会再读到比这个值更旧的值。也就是说，可获取的数据顺序必是单调递增的。
* 会话一致性（session consistency）。任何用户在某次会话中，一旦读到某个数据在某次更新后的值，那么在本次会话中就不会再读到比这值更旧的值会话一致性是在单调一致性的基础上进一步放松约束，只保证单个用户单个会话内的单调性，在不同用户或同一用户不同会话间则没有保障。示例case：php的session概念。 

&emsp; <font color = "red">分布式事务解决方案如下：</font>  

* 分布式事务模型DTP   
    * 一致性协议-XA两阶段提交
    * 一致性协议-XA三阶段提交
* 消息驱动模式（Message Driven）
    * 本地消息表（异步确保）-强一致性
    * 事务消息-最终一致性
    * 最大努力通知-最终一致性
* 事件溯源模式(Event Sourcing)，Saga事务模型-最终一致性 
* TCC模式-强一致性

## 1.2. 具体选型  
1. 何时选择基于消息实现的事务？  



