
<!-- TOC -->

- [1. 财务系统](#1-财务系统)
    - [1.1. 介绍](#11-介绍)
        - [1.1.1. 电商ERP](#111-电商erp)
        - [1.1.2. 财务系统](#112-财务系统)
        - [1.1.3. 记账——财务报表](#113-记账财务报表)
            - [1.1.3.1. 记账方法](#1131-记账方法)
            - [1.1.3.2. 权责发生制与收付实现制](#1132-权责发生制与收付实现制)
            - [1.1.3.3. 实时记账机制](#1133-实时记账机制)
        - [1.1.4. 生成凭证——财务凭证](#114-生成凭证财务凭证)
        - [1.1.5. 数据统计——数据图表](#115-数据统计数据图表)
    - [1.2. 设计](#12-设计)
        - [1.2.1. 数据定义](#121-数据定义)

<!-- /TOC -->

# 1. 财务系统 

## 1.1. 介绍
### 1.1.1. 电商ERP  
&emsp; 电商ERP系统是专门为电商行业设计和开发的ERP系统。它集成了电商业务所需的各种功能模块，以支持电商企业的运营和管理。电商ERP系统通常具备以下特点和功能：订单管理：支持电商订单的接收、处理、跟踪和管理。  

* 运营关注订单流水（订单支付成功与否）
* 店主关注交易流水（收入多少，支出多少）
* 财务关注资金流水（实付金额、手续费等）

### 1.1.2. 财务系统  
&emsp; 涵盖记账、对账及核算三大主要功能。  
&emsp; 银行或第三方支付机构的业务系统往往需要用户的资金数据进行核算，将处理结果汇总并生成凭证送往账务系统进行统一处理。账务系统充当虚拟货币的银行角色，银行资金管理系统管理着真实的货币。  
&emsp; 账务系统的主要功能是如实记录涉及资金变化的信息流和资金流，通过记账、对账、核算等来识别账目之间的差异，保证账户的内外部 (银行、账户余额)同步，通常涉及会计科目、账户等模块。 



### 1.1.3. 记账——财务报表  

#### 1.1.3.1. 记账方法 
&emsp; 记账方法可以分成单式记账法和复式记账法，复式记账法又可分成借贷、收付、增减三种  

&emsp; (I)单式记账法是一种比较简单的记账方法，指在会计核算中对每一项经济业务都只进行单方面的、不完整的记录记载，通常只在一个账户记一笔收支账，一般只登记现金的收支和借贷等事项(部分也登记实物的收、付)，其登记账目较多、手续单一，但在账户设置和记录上是不完整的，不能全面反映支付过程中业务行为的来龙去脉，也不便于检查账户记录的正确性。  
&emsp; (2)借贷复式记账是从单式记账法发展起来的一种比较完善的记账方法，比其他两种复式记账法更常用，也叫作复式记账凭证。与单式记账法相比较，其主要特点: 对每项经济业务都以相等的金额在两个或两个以上相互联系的账户中进行记录(也叫作双重记录);各账户之间客观上存在对应关系，对账户记录的结果可以进行试算平衡。  
&emsp; 与单式记账法相比，借贷复式记账法通过交易双方各自的角色进行记账，能更好、更真实地反映交易关系，也体现了交易双方资金运动的内在规律。每个交易角色各自记账的账本都是完整的，例如:针对一笔支付，第三方支付机构有自己的账，银行也有自己的账，都能各自输出自己的记账流水和账务数据。每个交易角色都能基于自己的账务数据进行独立核算在核算阶段也可以对整条交易链路进行核算。所以，借贷复式记账法能够较为全面、系统.真实地反映交易双方资金流水的增减，并有助于检查账户、处理账务和保证账务流水记录结果的正确性。  


&emsp; 我国会计记账采用复试借贷记账法，就是一笔经济业务要在多个科目下的账户里完成记账，采用借贷记账符号；比如我们从银行取现金，这时候银行存款减少了，同时库存现金增加了；复试记账的好处就是能够反映经济的来龙去脉。  
&emsp; 记账原则：有借必有贷，借贷必相等；  
&emsp; 会计恒等式：资产=负债+所有者权益。  

#### 1.1.3.2. 权责发生制与收付实现制  
&emsp; 权责发生制，也叫作应收应付制，指以取得收取款项的权利或支付款项的义务为标志来确定本期收入和费用的会计核算基础。这里通过现实场景说明权责发生制:若企业或公司与客户之间签订了相关销售订单，可能在履行承诺或者收到货款几个月后，在约定(签单)时发生了权责变更，这就会触发记账，即针对上面的场景，按会计行业的术语来讲，按收入和支出权责的实际发生时间来记账，并权责发生制。不考虑是否已收到或已支付款项，只解决对未来收入和费用何时予以确认，以及确认多少数额的问题。在什么现实场景下会用到权责发生制呢? 在会计行业内(大到国家财政部，小到会计师事务所)，一般规定企事业单位、政府财务需要采用权责发生制，详细记录企事业单位、政府内部往来、收支对象等相关信息并及时组织核对账务。  

#### 1.1.3.3. 实时记账机制  
&emsp; 实时记账机制和缓冲记账机制是记账的一种策略，在设计账务系统时，应该考虑到财务系统操作繁忙、账户操作原于性和数据吞吐量大等业务特证，所以需要针对不同的账户操作及日间业务高峰情况选择不同的记账策略  

### 1.1.4. 生成凭证——财务凭证  


### 1.1.5. 数据统计——数据图表    


## 1.2. 设计  

### 1.2.1. 数据定义
&emsp; 账务核心主要有 4 张表:分录流水、分户账、明细账、总账。  

* 分录流水是记账的凭证，记录每笔资金活动的来龙去脉
* 分户账记录账户的余额，有用户分户账、商户分户账、贷款分户账、内部分户账等
* 总账分为日总账和周期总账，日总账每日生成，周期总账由月末、季末、半年末、年末生成，记录每个科目的期末余额和本期借、贷发生额。  
* 明细账记录每个账户对应余额的变化  

&emsp; 当一笔支付业务发生时，首先会生成分录流水，然后驱动对应账户余额改变，在账户余额改变后，再生成明细账。  
&emsp; 日终时账务系统根据分录流水生成总账，根据业务需要，也可以先修改账户余额，然后异步生成分录流水，但无论是先生成会计分录，还是异步生成会计分录，都要保证分录流水与分户账余额的一致性，通过对日终账务系统的检查来保证账目的准确性。  

